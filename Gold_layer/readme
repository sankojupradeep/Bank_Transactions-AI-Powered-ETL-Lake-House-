# ðŸ¥‡ Gold Layer â€” Enhanced Dimension Tables (Delta Lake on S3/MinIO)

This project handles the **Gold Layer for dimension tables** in a financial transactions lakehouse.  
It reads **Silver Delta tables** from S3/MinIO, applies **enhancements**, and writes **managed Delta tables** for analytics.

---

## ðŸ“Œ Features

- **SCD Type 1**: Overwrite updates for dimension changes (e.g., name/balance updates).  
- **Aggregations**: Customer age groups, merchant counts per country, account balance stats.  
- **Window Functions**: Rank customers by age, dense rank merchants by category, running balance per account.  
- **Star Schema Ready**: Dimensions prepared for joins in fact tables.  
- **Fully on S3**: Delta tables stored under `s3a://bucket/gold/dim_tables/{table}_enhanced`.  
- **No Snowflake dependency**: Everything managed in Delta Lake on S3/MinIO.

---

## ðŸ“ Tables Created

| Table Name | Description |
|------------|-------------|
| `gold_layer.customers_enhanced` | Customers with age groups, ranking by gender, SCD1 updates |
| `gold_layer.merchants_enhanced` | Merchants with top-ranked merchants per category & country |
| `gold_layer.accounts_enhanced`  | Accounts with balance buckets, running balances, aggregated metrics |

---

## ðŸ–¼ï¸ Architecture Diagram

```mermaid
flowchart LR
    S[ðŸ¥ˆ Silver Layer] --> G[ðŸ¥‡ Gold Layer]
    G --> C[Customers Enhanced]
    G --> M[Merchants Enhanced]
    G --> A[Accounts Enhanced]
