# ğŸ’¿ Silver Layer â€” Cleaned & Standardized Data (Delta Lake)

**Project:** Financial Transactions Lakehouse â€” Silver layer  
**Script:** `silver_delta_ingestion_incremental.py`  
**Purpose:** Transforms Bronze Delta tables into Silver layer with **data cleaning, enrichment, and incremental ingestion**.  

---

## âœ… What this does

- ğŸ“¥ Reads **Bronze Delta tables** (`customers`, `accounts`, `merchants`, `transactions`) from S3/MinIO  
- ğŸ”„ Performs **incremental ingestion** using timestamp columns  
- ğŸ§¹ Cleans, standardizes, and enriches data:
  - Fixes schema, normalizes formats, validates fields  
  - Derives **new features** (age, txn_date, debit flag, etc.)  
- â±ï¸ Supports **watermarking** for late-arriving data (`transactions`)  
- ğŸ’¾ Writes cleaned datasets to **Silver Delta tables** with checkpointing  
- ğŸ“Š Emits logs for monitoring (Grafana/ELK friendly)  

---

## ğŸ”§ Tech Stack

- âš¡ **Apache Spark (PySpark)** â€” tested with Spark **4.0.1**  
- ğŸŸ¢ **Delta Lake** (`delta-spark`) â€” for ACID reliability  
- ğŸ“¦ **MinIO (S3 API)** â€” local object store for raw/bronze/silver  
- ğŸ› ï¸ **Hadoop S3A connector** + **AWS SDK** (for S3 integration)  
- ğŸ **Python 3.8+** (tested on 3.12 â€” works fine with compatible packages)  
- ğŸ“Œ *(Optional)* Airflow for orchestration, Streamlit/Plotly for dashboards  

---

## ğŸ“ Tables Managed

- ğŸ‘¥ **customers** â†’ Cleaned, standardized, with `age` derived  
- ğŸ¬ **merchants** â†’ Normalized categories, country codes, cleaned names  
- ğŸ’³ **accounts** â†’ Enforces valid balances & opened_date, maps status  
- ğŸ§¾ **transactions** â†’ Watermarked, partitioned by `txn_year`, `txn_month`  

---

## â–¶ How it Works

1. **Read Bronze Delta tables** from `s3a://bucket/bronze/...`  
2. **Check last ingested timestamp** (if available in Silver)  
   - Load only **new rows** since last ingestion  
3. Apply **transformations**:
   - `customers`: validate DOB, email, clean names, calculate age  
   - `merchants`: normalize city, country, and category  
   - `accounts`: validate balance, enforce opened_date, map statuses  
   - `transactions`: add date/year/month partitions, watermarking for late data  
4. **Write to Silver Delta tables** at `s3a://bucket/silver/...` with checkpointing  
5. **Logs progress** and outputs sample data  

---

## ğŸ“‚ Data Flow

```mermaid
flowchart TD
    A[Bronze Layer - Delta Tables] -->|Transform & Incremental Load| B[Silver Layer - Cleaned Delta Tables]
    B --> C[Gold Layer]
